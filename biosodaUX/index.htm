<!doctype html>
<html class="no-js" lang="">

<head>
  <meta charset="utf-8">
  <title>BioSODA UX</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="manifest" href="site.webmanifest">
  <link rel="apple-touch-icon" href="icon.png">
  <link rel="stylesheet" type="text/css" href="js/vendor/DataTables/dataTables.bootstrap4.min.css"/>
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="css/normalize.css">
<link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/main.css">

  <meta name="theme-color" content="#fafafa">
</head>

<body>

  <!-- Add your site or application content here -->
  
	<div class="container" id="wholecontent">
		<div id="theCat" onclick="$('#demo').show(); $('#meow')[0].play();">
			 <audio id="meow">
				<source src="meow.mp3" type="audio/ogg">
			</audio> 
		</div>
		<div class="row" id="logo">
			<img src="biosoda_logo.png">
		</div>

		<!-- get video demo here https://mdbootstrap.com/docs/jquery/javascript/carousel/ -->
		<div class="row justify-content-md-center bg-light" id="demo">
			<div class="col-6 offset-3">
				<div id="carouselExampleIndicators" class="carousel slide row " data-ride="carousel">
					<div class="carousel-inner col-12 row">
						<a class="carousel-control-prev col-1" href="#carouselExampleIndicators" role="button" data-slide="prev">
							<span class="carousel-control-prev-icon" aria-hidden="true"></span>
							<span class="sr-only">Previous</span>
						</a>
						<div class="carousel-item active col-auto">
							<div class="carousel-caption d-none d-md-block">
							</div>
							<video controls class="embed-responsive-item col-12">
								<source src="video/v1.mp4" type="video/mp4">
							</video>
						</div>
						<div class="carousel-item col-auto">
							<div class="carousel-caption d-none d-md-block">
							</div>
							<video controls class="embed-responsive-item col-12">
								<source src="video/v2.mp4" type="video/mp4">
							</video>
						</div>
						<a class="carousel-control-next col-1" href="#carouselExampleIndicators" role="button" data-slide="next">
							<span class="carousel-control-next-icon" aria-hidden="true"></span>
							<span class="sr-only">Next</span>
						</a>
					</div>
					<div class="col-12 row">
						<ol class="carousel-indicators text-dark">
							<li data-target="#carouselExampleIndicators" data-slide-to="0" class="active bg-dark"></li>
							<li data-target="#carouselExampleIndicators" data-slide-to="1" class="bg-dark"></li>
						</ol>
					</div>
				</div>
			</div>
			<div class="col-3 text-right">
			<a href="#" onclick="$('#demo').hide(); pauseallvideos();">X</a>
			</div>
		</div>

		<div class="row justify-content-md-center" id="topsearch">
			<div class="col-md-8">
				<div class="row pb-0"><input class="col-10" name="topsearch" id="inputtopsearch"><button onclick="submitQuery();">search!</button></div>
				<div class="row p-0 m-0 searchexamples"><p>Examples: <a href="#" data-search="gene where apoc1 is present in sequence gene">gene</a>, <a href="#" data-search="tissue">tissue</a></p></div>
			</div>
		</div>
		
		<div class="row justify-content-md-center" id="interactapi">
			<div class="col-md-auto">
				<p class="twowaysmessage"></p>
				<div class="col-12 m-1 p-1 border twoways">
				</div>
			</div>
		</div>

		<div class="row" id="datatable">
			<div class="col-12 alert alert-success pb-0">
				<p>You are looking for a <strong id="lookingfor">gene</strong>. What should your result table look like?</p>
			</div>
			<div class="col-12">
				<div id="coltoggler">
					Add column:
					<button class="btn btn-primary bg-white text-primary" data-column="1">Entry name</button>
					<button class="btn btn-primary bg-white text-primary" data-column="2">Protein names</button>
					<button class="btn btn-primary bg-white text-primary" data-column="3">Gene names</button>
					<button class="btn btn-primary bg-white text-primary" data-column="4">Organism</button>
					<button class="btn btn-primary bg-white text-primary" data-column="5">Length</button>
				</div>
			</div>
			<div class="col-12">
				<!-- filters -->
			</div>
			<div class="col-12">
				<table id="example" class="table table-striped table-bordered" style="width:100%;">
					<thead>
						<tr>
							<th>Entry</th>
							<th>Entry name name</th>
							<th>Protein names</th>
							<th>Gene names</th>
							<th>Organism</th>
							<th>Length</th>
						</tr>
					</thead>
					<tbody>
						<tr>
							<td>P28474</td>
							<td>ADHX_MOUSE</td>
							<td>Alcohol dehydrogenase class-3</td>
							<td>Adh5, Adh-2, Adh2</td>
							<td>Mus musculus (Mouse)</td>
							<td>374</td>
						</tr>
						<tr>
							<td>P02057</td>
							<td>HBB_RABIT</td>
							<td>Hemoglobin subunit beta-1/2</td>
							<td>HBB1, HBB2</td>
							<td>Oryctolagus cuniculus (Rabbit)</td>
							<td>147</td>
						</tr>
					</tbody>
				</table>
			</div>
			<div class="row justify-content-md-center col-12" id="runquery">
				<button type="button" class="btn btn-success col-3">
					Run query now and fetch results
				</button>
			</div>
		</div>


	</div>

	<script src="js/vendor/modernizr-3.7.1.min.js"></script>
	<script src="js/vendor/jquery-3.3.1.min.js"></script>
	<script src="js/vendor/bootstrap.js"></script>
	<script src="js/plugins.js"></script>
	<script type="text/javascript" src="js/vendor/DataTables/datatables.min.js"></script>
	<script src="js/main.js"></script>

	<script>
		// https://getbootstrap.com/docs/4.0/components/carousel/
		// https://datatables.net/reference/option/
		$('.carousel').carousel({
			interval: 0,
		}).on('slide.bs.carousel', function () {
			pauseallvideos();
		});

		function pauseallvideos() {
			$('#demo video').each(function (vid) {
				this.pause();
			});
		}

		function submitQuery() {
			$('#demo').hide();
			$('#interactapi').show();
			$('#datatable').hide();
			$.ajax({
				url: "http://localhost:3003/",
				data: {q: $('#inputtopsearch').val()},
				method: 'POST'
			}).done(function(data) {
				// clone object and fill with data value
				$('.twoways').show();
				if (data.target.length > 0) {
					$('.twowaysmessage').text('Your query was interpreted by our NLP engine. We\'ve found the following concepts, please chose the approppriate:');
				} else {
					$('.twowaysmessage').text('Our NLP found nothing matching your query. Please refine.');
					$('.twoways').hide();
				}
				$('.twoways').empty();
				$(data.target).each(function(index) {
					console.log(this);
					$('.twoways').append('<button type="button" class="btn btn-success mr-1" data-found="' + this + '">' + this + '</button>');
				});
				
			});
		}

		$(document).ready(function() {
			$('#inputtopsearch').val('');
			$('#demo').hide();
			$('#interactapi').hide();
			$('#datatable').hide();
			table = $('#example').DataTable( {
				"scrollY": "200px",
				"paging": false,
				"searching": false,
				"ordering": false,
				scrollCollapse: true,
				info: false
			} );
			table.columns().visible(0);
			table.column(0).visible(1);

			$('#coltoggler button').on( 'click', function (e) {
				$('#runquery').show();
				e.preventDefault();
				// Get the column API object
				var column = table.column( $(this).attr('data-column') );
				$(this).toggleClass('bg-white text-primary');
				// Toggle the visibility
				column.visible( ! column.visible() );
			});

			$('.searchexamples a').on('click', function(e) {
				e.preventDefault();
				$('#inputtopsearch').val($(this).data('search'));
			});

			$('.twoways').on('click', function(e) {
				$('#demo').hide();
				$('#interactapi').hide();
				console.log(e.target);
				sibi = e.target;
				$('#lookingfor').text($(e.target).attr('data-found'));
				// zber next: get from ajax and fill datatable with possibilities
				$('#datatable').show();
				$('#runquery').hide();
			});

			$('#runquery').on('click', function(e) {
				alert('***MAGIC***');
			});

		});
	</script>

</body>

</html>
